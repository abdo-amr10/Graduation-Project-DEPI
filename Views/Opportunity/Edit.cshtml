@model My_Uni_Hub.Models.Pages.Opportunity

@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewBag.Title = "Edit Opportunity";
}

@section Styles {
    <link rel="stylesheet" href="~/css/OpportunityCreate.css" asp-append-version="true" />
    <!-- add any edit-specific css if you have one -->
}

<div class="dashboard-container">
    <main class="main-content">
        <div class="breadcrumb">
            <a asp-action="Index" asp-controller="Opportunity" asp-area="Admin">Manage Opportunities</a> / Edit Opportunity
        </div>

        <div class="header">
            <h1 class="header-title">Edit Opportunity</h1>
            <div>
                <a asp-action="Index" asp-controller="Opportunity" asp-area="Admin" class="btn btn-secondary">Back to list</a>
            </div>
        </div>

        <div class="form-container">
            <div class="form-card">
                <div id="successMessage" class="success-message" style="display:none;">
                    <strong>Success!</strong> Opportunity updated.
                </div>

                <!-- Use the form tag helper instead of Html.BeginForm to avoid BeginForm overload issues -->
                <form asp-action="Edit" asp-controller="Opportunity" asp-area="Admin" method="post" id="opportunityForm">
                    @Html.AntiForgeryToken()
                    @Html.HiddenFor(m => m.OpportunityId)

                    <!-- Basic Information -->
                    <div class="form-section">
                        <h2 class="form-section-title">Basic Information</h2>

                        <div class="form-row">
                            <div class="form-group">
                                <label asp-for="Title">Opportunity Title <span class="required">*</span></label>
                                <input asp-for="Title" class="form-control" placeholder="e.g., Summer Internship - Software Development" />
                                <span asp-validation-for="Title" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="Organization">Organization <span class="required">*</span></label>
                                <input asp-for="Organization" class="form-control" placeholder="e.g., Google Egypt" />
                                <span asp-validation-for="Organization" class="text-danger"></span>
                            </div>

                            <div class="form-group full">
                                <label asp-for="Description">Description <span class="required">*</span></label>
                                <textarea asp-for="Description" class="form-control" placeholder="Provide a detailed description of the opportunity..."></textarea>
                                <span asp-validation-for="Description" class="text-danger"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Opportunity Details -->
                    <div class="form-section">
                        <h2 class="form-section-title">Opportunity Details</h2>

                        <div class="form-row">
                            <div class="form-group">
                                <label asp-for="Type">Type <span class="required">*</span></label>

                                <!-- Let tag helper manage selected state -->
                                <select asp-for="Type" class="form-control">
                                    <option value="">Select Opportunity Type</option>
                                    <option value="Internship">Internship</option>
                                    <option value="Scholarship">Scholarship</option>
                                    <option value="Job">Job</option>
                                    <option value="Volunteer">Volunteer</option>
                                    <option value="Workshop">Workshop</option>
                                </select>

                                <span asp-validation-for="Type" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="FacultyId">Target Faculty <span class="required">*</span></label>

                                <!-- Controller must populate ViewBag.Faculties = new SelectList(faculties, "Id", "Name", Model.FacultyId) -->
                                <select asp-for="FacultyId" asp-items="ViewBag.Faculties" class="form-control">
                                    <option value="">Select Faculty</option>
                                </select>

                                <span asp-validation-for="FacultyId" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="ApplyLink">Application Link <span class="required">*</span></label>
                                <input asp-for="ApplyLink" class="form-control" placeholder="https://example.com/apply" />
                                <span asp-validation-for="ApplyLink" class="text-danger"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Timeline -->
                    <div class="form-section">
                        <h2 class="form-section-title">Timeline</h2>

                        <div class="form-row">
                            <div class="form-group">
                                <label asp-for="PostedAt">Posted Date <span class="required">*</span></label>
                                <input asp-for="PostedAt" type="date" class="form-control" value="@(Model.PostedAt.ToString("yyyy-MM-dd"))" />
                                <span asp-validation-for="PostedAt" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label for="Deadline">Application Deadline (optional)</label>
                                <input id="Deadline" name="Deadline" type="date" class="form-control" />
                                <span class="help-text">Optional deadline if applicable</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <a asp-action="Index" asp-controller="Opportunity" asp-area="Admin" class="btn btn-secondary">Cancel</a>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>

            </div>
        </div>
    </main>
</div>

@section Scripts {
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <partial name="_ValidationScriptsPartial" />
    <!-- If you need JS to dynamically load departments (you removed dept earlier), add it here -->
}
